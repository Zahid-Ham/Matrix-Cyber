{"openapi":"3.1.0","info":{"title":"Matrix","description":"Agent-Driven Cyber Threat Simulator - AI-powered security testing platform","version":"1.0.0"},"paths":{"/health":{"get":{"tags":["Health"],"summary":"Health Check","description":"Health check endpoint.","operationId":"health_check_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/":{"get":{"tags":["Info"],"summary":"Root","description":"API information.","operationId":"root__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/auth/register":{"post":{"tags":["Authentication"],"summary":"Register","description":"Register a new user.","operationId":"register_api_auth_register_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserCreate"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Token"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/login":{"post":{"tags":["Authentication"],"summary":"Login","description":"Login with email and password.","operationId":"login_api_auth_login_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserLogin"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Token"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/me":{"get":{"tags":["Authentication"],"summary":"Get Current User Info","description":"Get current user information.","operationId":"get_current_user_info_api_auth_me_get","security":[{"HTTPBearer":[]}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserResponse"}}}}}},"put":{"tags":["Authentication"],"summary":"Update Current User","description":"Update current user profile.","operationId":"update_current_user_api_auth_me_put","security":[{"HTTPBearer":[]}],"parameters":[{"name":"full_name","in":"query","required":false,"schema":{"type":"string","title":"Full Name"}},{"name":"company","in":"query","required":false,"schema":{"type":"string","title":"Company"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/scans/":{"post":{"tags":["Scans"],"summary":"Create Scan","description":"Create a new security scan.","operationId":"create_scan_api_scans__post","security":[{"HTTPBearer":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ScanCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ScanResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["Scans"],"summary":"List Scans","description":"List user's scans with pagination.","operationId":"list_scans_api_scans__get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"page","in":"query","required":false,"schema":{"type":"integer","default":1,"title":"Page"}},{"name":"size","in":"query","required":false,"schema":{"type":"integer","default":20,"title":"Size"}},{"name":"status","in":"query","required":false,"schema":{"anyOf":[{"$ref":"#/components/schemas/ScanStatus"},{"type":"null"}],"title":"Status"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ScanListResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/scans/{scan_id}":{"get":{"tags":["Scans"],"summary":"Get Scan","description":"Get a specific scan by ID.","operationId":"get_scan_api_scans__scan_id__get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"scan_id","in":"path","required":true,"schema":{"type":"integer","title":"Scan Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ScanResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Scans"],"summary":"Delete Scan","description":"Delete a scan.","operationId":"delete_scan_api_scans__scan_id__delete","security":[{"HTTPBearer":[]}],"parameters":[{"name":"scan_id","in":"path","required":true,"schema":{"type":"integer","title":"Scan Id"}}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/scans/{scan_id}/start":{"post":{"tags":["Scans"],"summary":"Start Scan","description":"Start a pending scan.","operationId":"start_scan_api_scans__scan_id__start_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"scan_id","in":"path","required":true,"schema":{"type":"integer","title":"Scan Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ScanResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/scans/{scan_id}/cancel":{"post":{"tags":["Scans"],"summary":"Cancel Scan","description":"Cancel a running scan.","operationId":"cancel_scan_api_scans__scan_id__cancel_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"scan_id","in":"path","required":true,"schema":{"type":"integer","title":"Scan Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ScanResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/vulnerabilities/":{"get":{"tags":["Vulnerabilities"],"summary":"List Vulnerabilities","description":"List vulnerabilities with filters.","operationId":"list_vulnerabilities_api_vulnerabilities__get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"scan_id","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Scan Id"}},{"name":"page","in":"query","required":false,"schema":{"type":"integer","default":1,"title":"Page"}},{"name":"size","in":"query","required":false,"schema":{"type":"integer","default":50,"title":"Size"}},{"name":"severity","in":"query","required":false,"schema":{"anyOf":[{"$ref":"#/components/schemas/Severity"},{"type":"null"}],"title":"Severity"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/VulnerabilityListResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/vulnerabilities/scan/{scan_id}/summary":{"get":{"tags":["Vulnerabilities"],"summary":"Get Vulnerability Summary","description":"Get vulnerability count summary for a scan.","operationId":"get_vulnerability_summary_api_vulnerabilities_scan__scan_id__summary_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"scan_id","in":"path","required":true,"schema":{"type":"integer","title":"Scan Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/VulnerabilitySummary"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/vulnerabilities/{vuln_id}":{"get":{"tags":["Vulnerabilities"],"summary":"Get Vulnerability","description":"Get a specific vulnerability by ID.","operationId":"get_vulnerability_api_vulnerabilities__vuln_id__get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"vuln_id","in":"path","required":true,"schema":{"type":"integer","title":"Vuln Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/VulnerabilityResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"patch":{"tags":["Vulnerabilities"],"summary":"Update Vulnerability","description":"Update vulnerability status (mark as false positive, verified, fixed).","operationId":"update_vulnerability_api_vulnerabilities__vuln_id__patch","security":[{"HTTPBearer":[]}],"parameters":[{"name":"vuln_id","in":"path","required":true,"schema":{"type":"integer","title":"Vuln Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/VulnerabilityUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/VulnerabilityResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/test/xss":{"get":{"tags":["Test Bench"],"summary":"Xss Vulnerability","description":"Vulnerable to Reflected XSS.\nReflects the 'q' parameter directly without sanitization.","operationId":"xss_vulnerability_api_test_xss_get","parameters":[{"name":"q","in":"query","required":false,"schema":{"type":"string","default":"","title":"Q"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/test/sqli":{"get":{"tags":["Test Bench"],"summary":"Sqli Vulnerability","description":"Vulnerable to SQL Injection.\nSimulates a vulnerable SQL query.","operationId":"sqli_vulnerability_api_test_sqli_get","parameters":[{"name":"id","in":"query","required":false,"schema":{"type":"string","default":"","title":"Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/test/auth-bypass":{"post":{"tags":["Test Bench"],"summary":"Auth Bypass","description":"Vulnerable to Authentication Bypass/Weak Password.\nAccepts 'admin' / 'admin'.","operationId":"auth_bypass_api_test_auth_bypass_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}}},"components":{"schemas":{"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"LoginRequest":{"properties":{"username":{"type":"string","title":"Username"},"password":{"type":"string","title":"Password"}},"type":"object","required":["username","password"],"title":"LoginRequest"},"ScanCreate":{"properties":{"target_url":{"type":"string","title":"Target Url","description":"URL of the target to scan"},"target_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Target Name","description":"Friendly name for the target"},"scan_type":{"type":"string","title":"Scan Type","description":"Type of scan: full, quick, or custom","default":"full"},"agents_enabled":{"items":{"type":"string"},"type":"array","title":"Agents Enabled","description":"List of agent types to enable","default":["sql_injection","xss","auth","api_security"]}},"type":"object","required":["target_url"],"title":"ScanCreate","description":"Schema for creating a new scan."},"ScanListResponse":{"properties":{"items":{"items":{"$ref":"#/components/schemas/ScanResponse"},"type":"array","title":"Items"},"total":{"type":"integer","title":"Total"},"page":{"type":"integer","title":"Page"},"size":{"type":"integer","title":"Size"},"pages":{"type":"integer","title":"Pages"}},"type":"object","required":["items","total","page","size","pages"],"title":"ScanListResponse","description":"Schema for paginated scan list."},"ScanResponse":{"properties":{"id":{"type":"integer","title":"Id"},"target_url":{"type":"string","title":"Target Url"},"target_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Target Name"},"scan_type":{"type":"string","title":"Scan Type"},"status":{"$ref":"#/components/schemas/ScanStatus"},"progress":{"type":"integer","title":"Progress"},"total_vulnerabilities":{"type":"integer","title":"Total Vulnerabilities","default":0},"critical_count":{"type":"integer","title":"Critical Count","default":0},"high_count":{"type":"integer","title":"High Count","default":0},"medium_count":{"type":"integer","title":"Medium Count","default":0},"low_count":{"type":"integer","title":"Low Count","default":0},"info_count":{"type":"integer","title":"Info Count","default":0},"technology_stack":{"items":{"type":"string"},"type":"array","title":"Technology Stack","default":[]},"agents_enabled":{"items":{"type":"string"},"type":"array","title":"Agents Enabled","default":[]},"error_message":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error Message"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"started_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Started At"},"completed_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Completed At"}},"type":"object","required":["id","target_url","scan_type","status","progress","created_at"],"title":"ScanResponse","description":"Schema for scan response."},"ScanStatus":{"type":"string","enum":["pending","running","completed","failed","cancelled"],"title":"ScanStatus","description":"Scan status enumeration."},"Severity":{"type":"string","enum":["critical","high","medium","low","info"],"title":"Severity","description":"Vulnerability severity levels."},"Token":{"properties":{"access_token":{"type":"string","title":"Access Token"},"token_type":{"type":"string","title":"Token Type","default":"bearer"},"user":{"$ref":"#/components/schemas/UserResponse"}},"type":"object","required":["access_token","user"],"title":"Token","description":"Schema for JWT token response."},"UserCreate":{"properties":{"email":{"type":"string","format":"email","title":"Email"},"username":{"type":"string","maxLength":50,"minLength":3,"title":"Username"},"password":{"type":"string","minLength":8,"title":"Password"},"full_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Full Name"},"company":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Company"}},"type":"object","required":["email","username","password"],"title":"UserCreate","description":"Schema for user registration."},"UserLogin":{"properties":{"email":{"type":"string","format":"email","title":"Email"},"password":{"type":"string","title":"Password"}},"type":"object","required":["email","password"],"title":"UserLogin","description":"Schema for user login."},"UserResponse":{"properties":{"id":{"type":"integer","title":"Id"},"email":{"type":"string","title":"Email"},"username":{"type":"string","title":"Username"},"full_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Full Name"},"company":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Company"},"is_active":{"type":"boolean","title":"Is Active"},"is_verified":{"type":"boolean","title":"Is Verified"},"created_at":{"type":"string","format":"date-time","title":"Created At"}},"type":"object","required":["id","email","username","is_active","is_verified","created_at"],"title":"UserResponse","description":"Schema for user response."},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"},"VulnerabilityListResponse":{"properties":{"items":{"items":{"$ref":"#/components/schemas/VulnerabilityResponse"},"type":"array","title":"Items"},"total":{"type":"integer","title":"Total"},"page":{"type":"integer","title":"Page"},"size":{"type":"integer","title":"Size"}},"type":"object","required":["items","total","page","size"],"title":"VulnerabilityListResponse","description":"Schema for paginated vulnerability list."},"VulnerabilityResponse":{"properties":{"id":{"type":"integer","title":"Id"},"vulnerability_type":{"$ref":"#/components/schemas/VulnerabilityType"},"severity":{"$ref":"#/components/schemas/Severity"},"cvss_score":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Cvss Score"},"url":{"type":"string","title":"Url"},"parameter":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Parameter"},"method":{"type":"string","title":"Method","default":"GET"},"title":{"type":"string","title":"Title"},"description":{"type":"string","title":"Description"},"evidence":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Evidence"},"ai_confidence":{"type":"number","title":"Ai Confidence","default":0.0},"ai_analysis":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Ai Analysis"},"remediation":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Remediation"},"remediation_code":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Remediation Code"},"reference_links":{"items":{"type":"string"},"type":"array","title":"Reference Links","default":[]},"owasp_category":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Owasp Category"},"cwe_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Cwe Id"},"is_false_positive":{"type":"boolean","title":"Is False Positive","default":false},"is_verified":{"type":"boolean","title":"Is Verified","default":false},"is_fixed":{"type":"boolean","title":"Is Fixed","default":false},"detected_by":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Detected By"},"detected_at":{"type":"string","format":"date-time","title":"Detected At"},"scan_id":{"type":"integer","title":"Scan Id"}},"type":"object","required":["id","vulnerability_type","severity","url","title","description","detected_at","scan_id"],"title":"VulnerabilityResponse","description":"Schema for vulnerability response."},"VulnerabilitySummary":{"properties":{"total":{"type":"integer","title":"Total"},"critical":{"type":"integer","title":"Critical"},"high":{"type":"integer","title":"High"},"medium":{"type":"integer","title":"Medium"},"low":{"type":"integer","title":"Low"},"info":{"type":"integer","title":"Info"}},"type":"object","required":["total","critical","high","medium","low","info"],"title":"VulnerabilitySummary","description":"Summary of vulnerabilities by severity."},"VulnerabilityType":{"type":"string","enum":["sql_injection","xss_reflected","xss_stored","xss_dom","csrf","idor","auth_bypass","broken_auth","sensitive_data","security_misconfig","injection_other","broken_access","ssrf","xxe","insecure_deserialization","file_upload","path_traversal","open_redirect","info_disclosure","other"],"title":"VulnerabilityType","description":"Types of vulnerabilities detected."},"VulnerabilityUpdate":{"properties":{"is_false_positive":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Is False Positive"},"is_verified":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Is Verified"},"is_fixed":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Is Fixed"}},"type":"object","title":"VulnerabilityUpdate","description":"Schema for updating vulnerability status."}},"securitySchemes":{"HTTPBearer":{"type":"http","scheme":"bearer"}}}}