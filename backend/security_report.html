<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Security Scan Report - http://example.com</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; line-height: 1.6; color: #333; background: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 40px 20px; margin-bottom: 30px; border-radius: 8px; }
        h1 { font-size: 2.5em; margin-bottom: 10px; }
        .metadata { opacity: 0.9; font-size: 0.9em; }
        .summary { background: white; padding: 30px; margin-bottom: 30px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin: 20px 0; }
        .stat-card { background: #f8f9fa; padding: 20px; border-radius: 8px; text-align: center; }
        .stat-card h3 { font-size: 2em; margin-bottom: 5px; }
        .stat-card.critical { background: #fee; color: #c00; }
        .stat-card.high { background: #fef0e5; color: #d97706; }
        .stat-card.medium { background: #fef9e5; color: #ca8a04; }
        .stat-card.low { background: #eff6ff; color: #2563eb; }
        .findings { background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .finding { border-left: 4px solid #ddd; padding: 20px; margin-bottom: 20px; background: #fafafa; }
        .finding.critical { border-left-color: #dc2626; background: #fef2f2; }
        .finding.high { border-left-color: #ea580c; background: #fff7ed; }
        .finding.medium { border-left-color: #f59e0b; background: #fffbeb; }
        .finding.low { border-left-color: #3b82f6; background: #eff6ff; }
        .finding h3 { margin-bottom: 10px; color: #1f2937; }
        .badge { display: inline-block; padding: 4px 12px; border-radius: 12px; font-size: 0.85em; font-weight: 600; text-transform: uppercase; }
        .badge.critical { background: #dc2626; color: white; }
        .badge.high { background: #ea580c; color: white; }
        .badge.medium { background: #f59e0b; color: white; }
        .badge.low { background: #3b82f6; color: white; }
        .evidence { background: #f9fafb; padding: 15px; margin: 15px 0; border-radius: 4px; font-family: 'Courier New', monospace; font-size: 0.9em; }
        .remediation { background: #ecfdf5; padding: 15px; margin: 15px 0; border-radius: 4px; border-left: 3px solid #10b981; }
        pre { overflow-x: auto; }
        code { background: #1f2937; color: #10b981; padding: 2px 6px; border-radius: 3px; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Security Scan Report</h1>
            <div class="metadata">
                <p><strong>Target:</strong> http://example.com</p>
                <p><strong>Generated:</strong> 2025-12-24T18:10:33.651542</p>
                <p><strong>Scanner:</strong> Matrix Security Scanner v2.0</p>
            </div>
        </header>
        
        <div class="summary">
            <h2>Executive Summary</h2>
            <p style="margin: 15px 0;">The security scan identified 3 vulnerabilities, including 1 CRITICAL and 1 HIGH severity findings that require immediate attention.</p>
            
            <div class="stats">
                <div class="stat-card critical">
                    <h3>1</h3>
                    <p>Critical</p>
                </div>
                <div class="stat-card high">
                    <h3>1</h3>
                    <p>High</p>
                </div>
                <div class="stat-card medium">
                    <h3>1</h3>
                    <p>Medium</p>
                </div>
                <div class="stat-card low">
                    <h3>0</h3>
                    <p>Low</p>
                </div>
            </div>
        </div>
        
        <div class="findings">
            <h2>Detailed Findings</h2>

            <div class="finding critical">
                <h3>
                    <span class="badge critical">critical</span>
                    SQL Injection in 'id' parameter
                </h3>
                <p><strong>Location:</strong> <code>GET http://example.com/api/users</code></p>
                <p><strong>Parameter:</strong> <code>id</code></p>
                <p><strong>CVSS Score:</strong> 9.8 (Critical) - CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H</p>
                <p><strong>Confidence:</strong> 95.0%</p>
                
                <h4>Description</h4>
                <p>An error-based SQL injection vulnerability allows attackers to execute arbitrary SQL queries.</p>
                
                <h4>Evidence</h4>
                <div class="evidence">
                    <pre>MySQL error: 'You have an error in your SQL syntax near '1'='1''</pre>
                </div>
                
                <h4>Remediation</h4>
                <div class="remediation">
                    <p>Use parameterized queries (prepared statements) instead of string concatenation.</p>
                </div>
                
                <p style="margin-top: 15px; font-size: 0.9em; color: #6b7280;">
                    <strong>Standards:</strong> A03:2021 – Injection | CWE-89 | 
                    Detected by: sql_injection
                </p>
            </div>

            <div class="finding high">
                <h3>
                    <span class="badge high">high</span>
                    Reflected XSS in search parameter
                </h3>
                <p><strong>Location:</strong> <code>GET http://example.com/search</code></p>
                <p><strong>Parameter:</strong> <code>q</code></p>
                <p><strong>CVSS Score:</strong> 5.3 (Medium) - CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N</p>
                <p><strong>Confidence:</strong> 88.0%</p>
                
                <h4>Description</h4>
                <p>User input is reflected in HTML without proper encoding, allowing script injection.</p>
                
                <h4>Evidence</h4>
                <div class="evidence">
                    <pre>Payload <script>alert('XSS')</script> was reflected unencoded in response.</pre>
                </div>
                
                <h4>Remediation</h4>
                <div class="remediation">
                    <p>HTML-encode all user input before rendering in web pages. Use Content-Security-Policy header.</p>
                </div>
                
                <p style="margin-top: 15px; font-size: 0.9em; color: #6b7280;">
                    <strong>Standards:</strong> A03:2021 – Injection | CWE-79 | 
                    Detected by: xss
                </p>
            </div>

            <div class="finding medium">
                <h3>
                    <span class="badge medium">medium</span>
                    Missing CSRF protection on profile update
                </h3>
                <p><strong>Location:</strong> <code>POST http://example.com/api/profile/update</code></p>
                
                <p><strong>CVSS Score:</strong> 7.1 (High) - CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:H/A:N</p>
                <p><strong>Confidence:</strong> 85.0%</p>
                
                <h4>Description</h4>
                <p>State-changing operation lacks CSRF tokens, allowing cross-site request forgery.</p>
                
                <h4>Evidence</h4>
                <div class="evidence">
                    <pre>POST request succeeded without CSRF token or SameSite cookie attribute.</pre>
                </div>
                
                <h4>Remediation</h4>
                <div class="remediation">
                    <p>Implement synchronizer tokens pattern. Set SameSite=Strict on session cookies.</p>
                </div>
                
                <p style="margin-top: 15px; font-size: 0.9em; color: #6b7280;">
                    <strong>Standards:</strong> A01:2021 – Broken Access Control | CWE-352 | 
                    Detected by: csrf
                </p>
            </div>

        </div>
    </div>
</body>
</html>
